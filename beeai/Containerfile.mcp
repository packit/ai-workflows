FROM fedora:42

# Install system dependencies
RUN dnf -y install \
      python3 \
      python3-aiofiles \
      python3-aiohttp \
      python3-copr \
      python3-ogr \
      python3-pip \
      python3-requests \
      krb5-libs \
      krb5-workstation \
      centpkg \
      git \
    && dnf clean all

# Install FastMCP
RUN pip3 install --no-cache-dir fastmcp

# Create user
RUN useradd -m -G wheel mcp

# Copy required directories
# Individual directories are mounted as volumes in development
COPY mcp_server/ /home/mcp/mcp_server/
COPY common/ /home/mcp/common/
RUN chgrp -R root /home/mcp && chmod -R g+rwX /home/mcp
RUN mkdir /git-repos && chmod -R o+rwX /git-repos

USER mcp
WORKDIR /home/mcp

ENV PYTHONPATH=/home/mcp

CMD ["/bin/bash"]
